{% extends 'base.html' %}
{% block title %}Discussions | UniSpace{% endblock %}
{% block content %}
<div class="page-header">
    <h1>Discussions</h1>
    {% if user.is_authenticated %}
        <a class="btn primary" href="{% url 'discussions:create' %}">New Discussion</a>
    {% endif %}
</div>

<div class="layout">
    <section class="feed">
        {% if posts %}
            {% for post in posts %}
                <article class="post-card">
                    <div class="post-main">
                        <div class="post-header">
                            <span class="badge">{{ post.get_category_display }}</span>
                            <span class="meta">{{ post.created_at|date:"M d, Y" }} â€¢ {{ post.author }}</span>
                        </div>
                        <h2><a href="{% url 'discussions:detail' post.pk %}">{{ post.title }}</a></h2>
                        <p>{{ post.content|truncatewords:40 }}</p>
                        <div class="post-footer">
                            <span class="meta">{{ post.comments.count }} comments</span>
                        </div>
                    </div>
                    {% if post.image %}
                        <a class="post-thumb" href="{% url 'discussions:detail' post.pk %}">
                            <img src="{{ post.image.url }}" alt="{{ post.title }}">
                        </a>
                    {% endif %}
                </article>
            {% endfor %}
            {% include 'partials/pagination.html' with page_obj=page_obj %}
        {% else %}
            <p>No discussions yet.</p>
        {% endif %}
    </section>

    <aside class="sidebar">
        <div class="card">
            <h3>Categories</h3>
            <div class="filters">
                <a class="{% if not active_category %}active{% endif %}" href="{% url 'discussions:list' %}">All</a>
                {% for value, label in categories %}
                    <a class="{% if active_category == value %}active{% endif %}" href="{% url 'discussions:list' %}?category={{ value }}">{{ label }}</a>
                {% endfor %}
            </div>
        </div>
        <div class="card">
            <h3>Community tips</h3>
            <p class="meta">Share context, add code snippets, and keep discussions respectful.</p>
        </div>
    </aside>
</div>
{% endblock %}
