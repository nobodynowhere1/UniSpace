{% extends 'base.html' %}
{% block title %}Profile | UniSpace{% endblock %}
{% block content %}
<div class="page-header">
    <h1>Profile</h1>
</div>

<section class="card">
    <h2>Account</h2>
    <p><strong>Username:</strong> {{ user.username }}</p>
    <p><strong>Email:</strong> {{ user.email }}</p>
    <p><strong>Joined:</strong> {{ user.date_joined|date:"F j, Y" }}</p>
</section>

<section class="card">
    <h2>Avatar</h2>
    <div class="avatar-row">
        {% if user.profile.avatar %}
            <img class="avatar avatar-large" src="{{ user.profile.avatar.url }}" alt="{{ user.username }}">
        {% else %}
            <span class="avatar avatar-large avatar-placeholder">{{ user.username|first|upper }}</span>
        {% endif %}
        <form method="post" action="{% url 'accounts:avatar' %}" enctype="multipart/form-data">
            {% csrf_token %}
            {{ avatar_form.as_p }}
            <button type="submit" class="btn primary">Upload photo</button>
        </form>
    </div>
</section>

<section class="card">
    <h2>My Discussions</h2>
    {% if user_posts %}
        <ul class="item-list">
            {% for post in user_posts %}
                <li>
                    <a href="{% url 'discussions:detail' post.pk %}">{{ post.title }}</a>
                    <div class="inline-actions">
                        <a class="link" href="{% url 'discussions:update' post.pk %}">Edit</a>
                        <a class="link danger" href="{% url 'discussions:delete' post.pk %}">Delete</a>
                    </div>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>No discussions yet.</p>
    {% endif %}
</section>

<section class="card">
    <h2>My Buy &amp; Sell</h2>
    {% if user_products %}
        <ul class="item-list">
            {% for product in user_products %}
                <li>
                    <a href="{% url 'marketplace:detail' product.pk %}">{{ product.title }}</a>
                    <div class="inline-actions">
                        <a class="link" href="{% url 'marketplace:update' product.pk %}">Edit</a>
                        <a class="link danger" href="{% url 'marketplace:delete' product.pk %}">Delete</a>
                    </div>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>No products yet.</p>
    {% endif %}
</section>

<section class="card">
    <h2>My Lost &amp; Found</h2>
    {% if user_items %}
        <ul class="item-list">
            {% for item in user_items %}
                <li>
                    <a href="{% url 'lostfound:detail' item.pk %}">{{ item.title }}</a>
                    <div class="inline-actions">
                        <a class="link" href="{% url 'lostfound:update' item.pk %}">Edit</a>
                        <a class="link danger" href="{% url 'lostfound:delete' item.pk %}">Delete</a>
                    </div>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>No items yet.</p>
    {% endif %}
</section>
{% endblock %}
